(()=>{var He=window.document;function Bn(n){return function(){return window.document.createElement(n)}}function Ke(n){return function(){return window.document.createTextNode(n)}}function Ye(n){return function(){return window.document.getElementById(n)}}var Ko=function(n,t){for(var r=n>t?-1:1,e=new Array(r*(t-n)+1),a=n,o=0;a!==t;)e[o++]=a,a+=r;return e[o]=a,e},fl=function(n,t){if(n<1)return[];var r=new Array(n);return r.fill(t)},ll=function(n,t){for(var r=[],e=0,a=0;a<n;a++)r[e++]=t;return r},sl=typeof Array.prototype.fill=="function"?fl:ll;var Fn=function(n){return n.length},Xe=function(n,t,r){return r.length===0?n({}):t(r[0])(r.slice(1))},Yo=function(n,t,r,e){return e<0||e>=r.length?t:n(r[e])};var Zo=function(n,t,r,e,a){if(r<0||r>a.length)return t;var o=a.slice();return o.splice(r,0,e),n(o)},Xo=function(n,t,r,e){if(r<0||r>=e.length)return t;var a=e.slice();return a.splice(r,1),n(a)},nu=function(n,t,r,e,a){if(r<0||r>=a.length)return t;var o=a.slice();return o[r]=e,n(o)},lr=function(n){return n.slice().reverse()};var tu=function(n,t,r){for(var e=r.length,a=t,o=new Array(e),u=0;u<e;u++)a=n(a)(r[u]),o[u]=a;return o};var ru=function(n,t,r){return r.slice(n,t)};var eu=function(n){return function(t){for(var r=t.length,e=new Array(r),a=0;a<r;a++)e[a]=n(t[a]);return e}};var na={compose:function(n){return function(t){return function(r){return n(t(r))}}}};var z=function(n){return n.identity},Y={identity:function(n){return n},Semigroupoid0:function(){return na}};var $n=!0;var mn=function(n){return function(t){return function(r){return n(r)(t)}}},rn=function(n){return function(t){return n}};var en=function(){function n(){}return n.value=new n,n}();var m=function(n){return n.map};var sn=function(n){return m(n)(rn(void 0))};var bn={map:eu};var au=function(n){return function(t){return n.length===0?t:t.length===0?n:n.concat(t)}};var Sn=function(n){return n.reflectSymbol};var jn=function(n){return function(t){return t[n]}};var rt={append:au};var C=function(n){return n.append};var X=function(n){return n.apply};var Dt=function(n){var t=X(n),r=m(n.Functor0());return function(e){return function(a){return function(o){return t(r(e)(a))(o)}}}};var S=function(n){return n.pure};var Rt=function(n){var t=S(n);return function(r){return function(e){if(r)return e;if(!r)return t(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[r.constructor.name,e.constructor.name])}}},sr=function(n){var t=X(n.Apply0()),r=S(n);return function(e){return function(a){return t(r(e))(a)}}};var pn=function(n){return n.bind};var Wr=function(n){var t=pn(n.Bind1()),r=Rt(n.Applicative0());return function(e){return function(a){return t(e)(function(o){return r(o)(a)})}}};var Ur=function(n){var t=pn(n.Bind1()),r=S(n.Applicative0());return function(e){return function(a){return t(e)(function(o){return t(a)(function(u){return r(o(u))})})}}};var cu="\uFFFF",fu="\0",Fl=Number.POSITIVE_INFINITY,xl=Number.NEGATIVE_INFINITY;var lu=function(n){return function(t){return function(r){return function(e){return function(a){return e<a?n:e===a?t:r}}}}};var su=lu;var pu=lu;var Rr=function(n){return function(t){return n===t}},_u=Rr,vu=Rr;var mu=Rr,du=Rr,Du=function(n){return function(t){return function(r){if(t.length!==r.length)return!1;for(var e=0;e<t.length;e++)if(!n(t[e])(r[e]))return!1;return!0}}};var oa={eq:du},ua={eqRecord:function(n){return function(t){return function(r){return!0}}}},hu=function(n){return n.eqRecord},ia=function(){return function(n){return{eq:hu(n)(en.value)}}};var Jt={eq:vu},yu={eq:mu},_r={eq:_u},ht=function(n){return n.eq1},D=function(n){return n.eq},Il=D(_r),Jr=function(n){return{eq:Du(D(n))}};var Br=function(n){var t=hu(n);return function(){return function(r){var e=Sn(r);return function(a){var o=D(a);return{eqRecord:function(u){return function(c){return function(i){var s=t(en.value)(c)(i),d=e(en.value),h=jn(d);return o(h(c))(h(i))&&s}}}}}}}},yt=function(n){var t=D(n);return function(r){return function(e){return Il(t(r)(e))(!1)}}};var T=function(){function n(){}return n.value=new n,n}(),I=function(){function n(){}return n.value=new n,n}(),$=function(){function n(){}return n.value=new n,n}();var Bt={eq:function(n){return function(t){return n instanceof T&&t instanceof T||n instanceof I&&t instanceof I||n instanceof $&&t instanceof $}}};var bu=function(n){return function(t){return n-t|0}};var gu=function(n){return function(t){return n+t|0}},wu=function(n){return function(t){return n*t|0}};var ca={add:gu,zero:0,mul:wu,one:1};var fa={sub:bu,Semiring0:function(){return ca}};var Q=function(){return{compare:su(T.value)($.value)(I.value),Eq0:function(){return Jt}}}(),jr=function(){return{compare:pu(T.value)($.value)(I.value),Eq0:function(){return yu}}}();var wt=function(n){return n.compare1},F=function(n){return n.compare};var zr=function(n){var t=F(n);return function(r){return function(e){var a=t(r)(e);return a instanceof T}}};var la=function(n){var t=F(n);return function(r){return function(e){var a=t(r)(e);if(a instanceof T)return e;if(a instanceof $||a instanceof I)return r;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[a.constructor.name])}}};var Gn=function(n){return n.top};var Ft={top:cu,bottom:fu,Ord0:function(){return jr}};var Vn=function(n){return n.bottom};var Ul=z(Y),l=function(){function n(){}return n.value=new n,n}(),f=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}();var An=function(n){return function(t){return function(r){if(r instanceof l)return n;if(r instanceof f)return t(r.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,t.constructor.name,r.constructor.name])}}},kt=An(!0)(rn(!1));var _n={map:function(n){return function(t){return t instanceof f?new f(n(t.value0)):l.value}}};var Vr=function(n){return An(n)(Ul)},jt=function(){return function(n){if(n instanceof f)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var Fu=function(n){return Math.min(Math.abs(n),2147483647)},xu=function(n){return function(t){return t===0?0:t>0?Math.floor(n/t):-Math.floor(n/-t)}},Mu=function(n){return function(t){if(t===0)return 0;var r=Math.abs(t);return(n%r+r)%r}};var Tu={Ring0:function(){return fa}};var pa=function(n){return n.mod};var Qr={degree:Fu,div:xu,mod:Mu,CommutativeRing0:function(){return Tu}},_a=function(n){return n.div};var fn=function(n){return n.mempty};var Iu=function(n){return function(){return n}},Cu=function(n){return function(t){return function(){return t(n())()}}};var Su=function(n,t,r){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+o+")",t,o);return e=1,a=r(),e=2,a}},xt={Applicative0:function(){return Mt},Bind1:function(){return Au}},Au={bind:Cu,Apply0:function(){return Nu(0)}},Mt={pure:Iu,Apply0:function(){return Nu(0)}},Pu=Su("functorEffect","Effect",function(){return{map:sr(Mt)}}),Nu=Su("applyEffect","Effect",function(){return{apply:Ur(xt),Functor0:function(){return Pu(0)}}}),Tt=Pu(20);var qu=function(n){return function(){return{value:n}}};var zt=function(n){return function(){return n.value}};var It=function(n){return function(t){return function(){t.value=n}}};var va=qu;var Ou=function(n){return function(t){return function(){return n(t())}}},Wu=function(n){return function(){return n}},Uu=function(n){return function(t){return function(){return t(n())()}}};var Zl=function(n,t,r){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+o+")",t,o);return e=1,a=r(),e=2,a}};var Hr={map:Ou};var zu={Applicative0:function(){return Gu},Bind1:function(){return Kr}},Kr={bind:Uu,Apply0:function(){return Vu(0)}},Gu={pure:Wu,Apply0:function(){return Vu(0)}},Vu=Zl("applyST","Control.Monad.ST.Internal",function(){return{apply:Ur(zu),Functor0:function(){return Hr}}});function Xl(n){return n}var Qu=Xl;function ns(n){return n.slice()}var Hu=ns;var Ku=function(n,t){return t.push(n)};var Zr=function(t){return function(r){return function(){return t(r)}}},Da=function(t){return function(r){return function(e){return function(){return t(r,e)}}}};var Yu=Zr(Qu);var is=Zr(Hu),Zu=function(n){return function(t){return function(){var e=is(t)();return n(e)(),Yu(e)()}}};var ha=Da(Ku);var ni=function(n){return function(t){return n&&t}},ti=function(n){return function(t){return n||t}},ri=function(n){return!n};var Gt=function(n){return n.not};var Xr=function(n){return n.disj},ct={ff:!1,tt:!0,implies:function(n){return function(t){return Xr(ct)(Gt(ct)(n))(t)}},conj:ni,disj:ti,not:ri};var ei=function(n){return function(t){return function(r){for(var e=t,a=r.length,o=a-1;o>=0;o--)e=n(r[o])(e);return e}}},ai=function(n){return function(t){return function(r){for(var e=t,a=r.length,o=0;o<a;o++)e=n(e)(r[o]);return e}}};var p=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}();var Kn=function(n){return n.value1};var lt=function(n){return n.value0};var fi=function(n){var t=D(n);return function(r){var e=D(r);return{eq:function(a){return function(o){return t(a.value0)(o.value0)&&e(a.value1)(o.value1)}}}}},ya=function(n){var t=F(n),r=fi(n.Eq0());return function(e){var a=F(e),o=r(e.Eq0());return{compare:function(u){return function(c){var i=t(u.value0)(c.value0);return i instanceof T?T.value:i instanceof I?I.value:a(u.value1)(c.value1)}},Eq0:function(){return o}}}};var ae=function(n){return n};var Fa=function(){return ae};var Cs=D(Bt);var k=function(n){return n.foldr};var L=function(n){return n.foldl};var Ma=function(n){var t=L(n);return function(r){var e=function(a){return function(o){if(a instanceof l)return new f(o);if(a instanceof f)return new f(function(){var u=Cs(r(a.value0)(o))(T.value);return u?a.value0:o}());throw new Error("Failed pattern match at Data.Foldable (line 454, column 3 - line 454, column 27): "+[a.constructor.name,o.constructor.name])}};return t(e)(l.value)}};var bi=function(n){var t=k(n);return function(r){var e=C(r.Semigroup0()),a=fn(r);return function(o){return t(function(u){return function(c){return e(o(u))(c)}})(a)}}},an={foldr:ei,foldl:ai,foldMap:function(n){return bi(an)(n)}};var gi=function(n){var t=L(n);return function(r){var e=pn(r.Bind1()),a=S(r.Applicative0());return function(o){return function(u){return t(function(c){return function(i){return e(c)(mn(o)(i))}})(a(u))}}}};var ce=function(n){return function(t){return function(r){return n(t,r)}}},Ct=function(n){return function(t){return function(r){return function(e){return n(t,r,e)}}}},Dr=function(n){return function(t){return function(r){return function(e){return function(a){return n(t,r,e,a)}}}}},hr=function(n){return function(t){return function(r){return function(e){return function(a){return function(o){return n(t,r,e,a,o)}}}}}};var Fi=function(n){return function(t){for(var r=t.length,e=Array(r),a=0;a<r;a++)e[a]=n(a)(t[a]);return e}};var St=function(n){return n.mapWithIndex};var yr={mapWithIndex:Fi,Functor0:function(){return bn}};var Ci=function(){function n(a){return[a]}function t(a){return function(o){return[a,o]}}function r(a){return function(o){return function(u){return[a,o,u]}}}function e(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(u){return function(c){return function(i){function s(d,h){switch(h-d){case 0:return u([]);case 1:return o(n)(c(i[d]));case 2:return a(o(t)(c(i[d])))(c(i[d+1]));case 3:return a(a(o(r)(c(i[d])))(c(i[d+1])))(c(i[d+2]));default:var y=d+Math.floor((h-d)/4)*2;return a(o(e)(s(d,y)))(s(y,h))}}return s(0,i.length)}}}}}}();var Qt=function(n){return n},Ht=function(n){return n},Vs={map:function(n){return function(t){return function(r){var e=Qt(t)(r);return{accum:e.accum,value:n(e.value)}}}}},Qs={map:function(n){return function(t){return function(r){var e=Ht(t)(r);return{accum:e.accum,value:n(e.value)}}}}},Hs={apply:function(n){return function(t){return function(r){var e=Qt(t)(r),a=Qt(n)(e.accum);return{accum:a.accum,value:a.value(e.value)}}}},Functor0:function(){return Vs}},Ks={apply:function(n){return function(t){return function(r){var e=Ht(n)(r),a=Ht(t)(e.accum);return{accum:a.accum,value:e.value(a.value)}}}},Functor0:function(){return Qs}},Ca={pure:function(n){return function(t){return{accum:t,value:n}}},Apply0:function(){return Hs}},Sa={pure:function(n){return function(t){return{accum:t,value:n}}},Apply0:function(){return Ks}};var wp=z(Y),st=function(n){return n.traverse};var Fp=function(n){var t=st(n);return function(r){return t(r)(wp)}},le={traverse:function(n){var t=n.Apply0();return Ci(X(t))(m(t.Functor0()))(S(n))},sequence:function(n){return Fp(le)(n)},Functor0:function(){return bn},Foldable1:function(){return an}},Kt=function(n){return n.sequence};var xp=function(n){var t=st(n)(Ca);return function(r){return function(e){return function(a){return Qt(t(function(o){return function(u){return r(u)(o)}})(a))(e)}}}},Pa=function(n){var t=xp(n);return function(r){return function(e){return function(a){return t(function(o){return function(u){var c=r(u)(o);return{accum:c,value:c}}})(e)(a).value}}}};var Oi=function(n){return function(t){return function(r){return function(e){return function(a){return function(o){for(var u=[],c=o;;){var i=a(c);if(n(i))return u;var s=t(i);u.push(r(s)),c=e(s)}}}}}}};var Wi=function(n){return function(t){return function(r){return function(e){return function(a){return function(o){for(var u=[],c=o;;){var i=a(c);u.push(r(i));var s=e(i);if(n(s))return u;c=t(s)}}}}}}};var Np=jt();var Ji={unfoldr1:Wi(kt)(Np)(lt)(Kn)};var $p=jt(),At=function(n){return n.unfoldr};var se={unfoldr:Oi(kt)($p)(lt)(Kn),Unfoldable10:function(){return Ji}};var Up=C(rt);var ki=function(){return hr(nu)(f.create)(l.value)}();var ji=function(){return Ct(Xe)(rn(l.value))(function(n){return function(t){return new f({head:n,tail:t})}})}();var zi=function(){return Ct(Xe)(rn(l.value))(function(n){return function(t){return new f(t)}})}();var R=function(n){return function(t){return Zu(ha(t))(n)()}},Na=Ct(ru),qa=function(n){return function(t){return n<=0?{before:[],after:t}:{before:Na(0)(n)(t),after:Na(n)(Fn(t))(t)}}};var Gi=Ct(tu);var Vi=ce(Ko);var Rp=function(n){return Fn(n)===0};var Qi=function(){return hr(Zo)(f.create)(l.value)}(),Hi=function(n){if(Rp(n))return l.value;if($n)return new f(Na(0)(Fn(n)-1|0)(n));throw new Error("Failed pattern match at Data.Array (line 351, column 1 - line 351, column 45): "+[n.constructor.name])},pe=function(){return Dr(Yo)(f.create)(l.value)}(),Ki=function(n){return pe(n)(Fn(n)-1|0)};var Yi=function(n){return pe(n)(0)};var _e=L(an);var Zi=function(){return Dr(Xo)(f.create)(l.value)}();var wr=function(n){return function(t){return Up([n])(t)}};var Jp=k(an),Xi=St(yr),Bp=L(an);var pt=function(n){return n.foldrWithIndex};var Fr=function(n){return n.foldlWithIndex};var kp=function(n){var t=pt(n);return function(r){var e=C(r.Semigroup0()),a=fn(r);return function(o){return t(function(u){return function(c){return function(i){return e(o(u)(c))(i)}}})(a)}}},_t={foldrWithIndex:function(n){return function(t){var r=Jp(function(a){return function(o){return n(a.value0)(a.value1)(o)}})(t),e=Xi(p.create);return function(a){return r(e(a))}}},foldlWithIndex:function(n){return function(t){var r=Bp(function(a){return function(o){return n(o.value0)(a)(o.value1)}})(t),e=Xi(p.create);return function(a){return r(e(a))}}},foldMapWithIndex:function(n){return kp(_t)(n)},Foldable0:function(){return an}};var jp=function(n){var t=Kt(n.Traversable2()),r=St(n.FunctorWithIndex0());return function(e){var a=t(e);return function(o){var u=r(o);return function(c){return a(u(c))}}}},La=function(n){return n.traverseWithIndex};var $a={traverseWithIndex:function(n){return jp($a)(n)},FunctorWithIndex0:function(){return yr},FoldableWithIndex1:function(){return _t},Traversable2:function(){return le}};var zp=function(n){var t=La(n)(Sa);return function(r){return function(e){return function(a){return Ht(t(function(o){return function(u){return function(c){return r(o)(c)(u)}}})(a))(e)}}}},nc=function(n){var t=zp(n);return function(r){return function(e){return function(a){return t(function(o){return function(u){return function(c){var i=r(o)(u)(c);return{accum:i,value:i}}}})(e)(a).value}}}};function ve(n){return new Error(n)}function me(n){return function(){throw n}}var Wa=function(n){return n()};var Kp=function(n){return Wa(me(n))},b=function(n){return Kp(ve(n))};var Yp=nc($a),tc=function(n){return function(t){return function(r){var e=ki(n)(t)(r);if(e instanceof l)return b("updateAt: index out of bound");if(e instanceof f)return e.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 12, column 5 - line 14, column 24): "+[e.constructor.name])}}},de=function(n){var t=ji(n);if(t instanceof l)return b("uncons: empty array");if(t instanceof f)return new p(t.value0.head,t.value0.tail);throw new Error("Failed pattern match at Data.Array.Unsafe (line 91, column 5 - line 95, column 19): "+[t.constructor.name])},De=function(n){var t=zi(n);if(t instanceof l)return b("tail: empty array");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 79, column 5 - line 81, column 24): "+[t.constructor.name])};var rc=function(n){return function(t){return function(r){return wr(t)(Yp(n)(t)(r))}}},ec=function(n){return function(t){return function(r){return wr(t)(Gi(n)(t)(r))}}};var he=function(n){var t=Ki(n);if(t instanceof l)return b("last: empty array");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 73, column 5 - line 75, column 21): "+[t.constructor.name])},ac=function(n){return function(t){return function(r){var e=Qi(n)(t)(r);if(e instanceof l)return b("insertAt: index out of bound");if(e instanceof f)return e.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 32, column 5 - line 34, column 22): "+[e.constructor.name])}}},ye=function(n){var t=Hi(n);if(t instanceof l)return b("init: empty array");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 85, column 5 - line 87, column 24): "+[t.constructor.name])},gn=function(n){return function(t){var r=pe(n)(t);if(r instanceof l)return b("index: empty array");if(r instanceof f)return r.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 61, column 5 - line 63, column 21): "+[r.constructor.name])}},xr=function(n){var t=Yi(n);if(t instanceof l)return b("head: empty array");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 67, column 5 - line 69, column 21): "+[t.constructor.name])},oc=function(n){return function(t){var r=Zi(n)(t);if(r instanceof l)return b("deleteAt: index out of bound");if(r instanceof f)return r.value0;throw new Error("Failed pattern match at Data.Array.Unsafe (line 38, column 5 - line 40, column 22): "+[r.constructor.name])}};var Zp=typeof Array.from=="function",Xp=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",n_=typeof String.prototype.fromCodePoint=="function",t_=typeof String.prototype.codePointAt=="function",uc=function(n){return t_?function(t){return t.codePointAt(0)}:n};var ic=function(n){return n_?String.fromCodePoint:n},cc=function(n){return function(t){return Xp?function(r){for(var e="",a=r[Symbol.iterator](),o=0;o<t;++o){var u=a.next();if(u.done)return e;e+=u.value}return e}:n(t)}},fc=function(n){return function(t){return Zp?function(r){return Array.from(r,t)}:n}};function vt(n){return n.charCodeAt(0)}function lc(n){return String.fromCharCode(n)}var sc=Vn(Ft),pc=Gn(Ft);var _c=function(n){return n.toEnum};var Ja=function(n){return n.fromEnum},vc=function(n){var t=_c(n),r=Ja(n),e=Vn(n.Bounded0());return function(a){return function(o){return function(u){var c=t(u);if(c instanceof f)return c.value0;if(c instanceof l){var i=u<r(e);return i?a:o}throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[c.constructor.name])}}}};var mc=function(n){return function(t){return function(r){return n(t(r)+1|0)}}},dc=function(n){return function(t){return function(r){return n(t(r)-1|0)}}};var Ua=function(n){return n>=vt(sc)&&n<=vt(pc)?new f(lc(n)):l.value},i_={succ:mc(Ua)(vt),pred:dc(Ua)(vt),Ord0:function(){return jr}};var Ba=function(){return{cardinality:vt(pc)-vt(sc)|0,toEnum:Ua,fromEnum:vt,Bounded0:function(){return Ft},Enum1:function(){return i_}}}();var ka=function(n){return n};var Zt=function(n){return n.length};var Xt=function(n){return function(t){return t.substring(n)}};var mt=function(n){return function(t){if(n>=0&&n<t.length)return t.charAt(n);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var Mr=Ja(Ba),T_=m(_n),E_=At(se),I_=_a(Qr),C_=pa(Qr);var bc=function(n){return function(t){return(((n-55296|0)*1024|0)+(t-56320|0)|0)+65536|0}};var gc=function(n){return 56320<=n&&n<=57343},wc=function(n){return 55296<=n&&n<=56319},Fc=function(n){var t=Zt(n);if(t===0)return l.value;if(t===1)return new f({head:Mr(mt(0)(n)),tail:""});var r=Mr(mt(1)(n)),e=Mr(mt(0)(n)),a=wc(e)&&gc(r);return a?new f({head:bc(e)(r),tail:Xt(2)(n)}):new f({head:e,tail:Xt(1)(n)})},S_=function(n){return T_(function(t){return new p(t.head,t.tail)})(Fc(n))},A_=function(n){return E_(S_)(n)},P_=function(n){var t=Mr(mt(0)(n)),r=wc(t)&&Zt(n)>1;if(r){var e=Mr(mt(1)(n)),a=gc(e);return a?bc(t)(e):t}return t},N_=uc(P_),q_=fc(A_)(N_),Zn=function(n){return Fn(q_(n))};var ja=function(){var n=vc(Ba)(Vn(Ft))(Gn(Ft));return function(t){return ka(n(t))}}(),L_=function(n){if(n<=65535)return ja(n);var t=I_(n-65536|0)(1024)+55296|0,r=C_(n-65536|0)(1024)+56320|0;return ja(t)+ja(r)};var $_=ic(L_),xc=function(n){return function(t){if(n<1)return"";var r=Fc(t);return r instanceof f?$_(r.value0.head)+xc(n-1|0)(r.value0.tail):t}},O_=cc(xc);var za=function(n){return function(t){var r=O_(n)(t);return{before:r,after:Xt(Zt(r))(t)}}};var W_=la(Q),Jn=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),wn=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),Xn=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),hn=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}(),H=function(){function n(t,r,e){this.value0=t,this.value1=r,this.value2=e}return n.create=function(t){return function(r){return function(e){return new n(t,r,e)}}},n}(),P=function(){function n(t,r,e){this.value0=t,this.value1=r,this.value2=e}return n.create=function(t){return function(r){return function(e){return new n(t,r,e)}}},n}(),vn=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}();var U_={eq:function(n){return function(t){return n instanceof Jn&&t instanceof Jn?n.value0.level===t.value0.level:n instanceof wn&&t instanceof wn?!0:n instanceof Xn&&t instanceof Xn?n.value0.href===t.value0.href:!1}}},R_=D(U_),Tr={eq:function(n){return function(t){return n instanceof hn&&t instanceof hn?n.value0.id===t.value0.id&&D(Jr(Tr))(n.value1)(t.value1):n instanceof H&&t instanceof H?n.value0.id===t.value0.id&&R_(n.value1)(t.value1)&&D(Jr(Tr))(n.value2)(t.value2):n instanceof P&&t instanceof P?n.value0.id===t.value0.id&&n.value1.bold===t.value1.bold&&n.value1.italic===t.value1.italic&&n.value2===t.value2:n instanceof vn&&t instanceof vn?n.value0.id===t.value0.id:!1}}},nr=function(n){return function(t){return t instanceof P?new P(t.value0,t.value1,n):b("updateText: invalid call")}},Tc=function(n){return function(t){if(t instanceof hn)return new hn({id:n},t.value1);if(t instanceof H)return new H({id:n},t.value1,t.value2);if(t instanceof P)return new P({id:n},t.value1,t.value2);if(t instanceof vn)return new vn({id:n});throw new Error("Failed pattern match at PlainText.Model.Node (line 71, column 1 - line 71, column 39): "+[n.constructor.name,t.constructor.name])}},Mn=function(n){return function(t){return t instanceof hn?new hn(t.value0,n):t instanceof H?new H(t.value0,t.value1,n):b("updateChildren: invalid call")}},Tn=function(n){return n instanceof P?n.value2:""},Ec=function(n){return function(t){var r=za(t)(Tn(n));return r.after}};var Ic=function(n){return function(t){var r=za(t)(Tn(n));return r.before}},yn=function(n){if(n instanceof hn||n instanceof H||n instanceof P||n instanceof vn)return n.value0.id;throw new Error("Failed pattern match at PlainText.Model.Node (line 77, column 1 - line 77, column 25): "+[n.constructor.name])},Cc=function(n){return Zn(Tn(n))},Er=function(n){return n instanceof P};var U=function(n){return n instanceof hn?n.value1:n instanceof H?n.value2:[]},ge=function(n){return function(t){var r=qa(t)(U(n));return r.after}};var we=function(n){return function(t){var r=qa(t)(U(n));return r.before}},Sc=function(n){return function(t){var r=oc(n)(U(t));return Mn(r)(t)}},J_=function(n){return function(t){return function(r){var e=function(a){return function(o){return o instanceof P||o instanceof vn?n(a)(o):_e(e)(n(a)(o))(U(o))}};return e(t)(r)}}},Ga=function(){var n=function(t){return function(r){return W_(t)(yn(r))}};return J_(n)(0)}(),Ac=function(n){return function(t){return function(r){var e=ac(n)(t)(U(r));return Mn(e)(r)}}},Ir=function(n){return function(t){return function(r){var e=tc(n)(t)(U(r));return Mn(e)(r)}}},Fe=function(n){return function(t){return gn(U(n))(t)}};var j_=z(Y),v=function(){function n(){}return n.value=new n,n}(),_=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}();var z_=function(n){var t=function(r){return function(e){var a=r,o=!1,u;function c(i,s){if(s instanceof _&&s.value1 instanceof _&&s.value1.value1 instanceof _){a=new _(s,i),e=s.value1.value1.value1;return}var d=function(y){return y instanceof _&&y.value1 instanceof _&&y.value1.value1 instanceof v?new _(n(y.value0),new _(n(y.value1.value0),v.value)):y instanceof _&&y.value1 instanceof v?new _(n(y.value0),v.value):v.value},h=function(y){return function(j){var tn=y,un=!1,Wt;function Qe(tt,Ho){if(tt instanceof _&&tt.value0 instanceof _&&tt.value0.value1 instanceof _&&tt.value0.value1.value1 instanceof _){tn=tt.value1,j=new _(n(tt.value0.value0),new _(n(tt.value0.value1.value0),new _(n(tt.value0.value1.value1.value0),Ho)));return}return un=!0,Ho}for(;!un;)Wt=Qe(tn,j);return Wt}};return o=!0,h(i)(d(s))}for(;!o;)u=c(a,e);return u}};return t(v.value)},Cr={map:z_};var J={foldr:function(n){return function(t){var r=function(){var a=function(o){return function(u){var c=o,i=!1,s;function d(h,y){if(y instanceof v)return i=!0,h;if(y instanceof _){c=new _(y.value0,h),u=y.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[h.constructor.name,y.constructor.name])}for(;!i;)s=d(c,u);return s}};return a(v.value)}(),e=L(J)(mn(n))(t);return function(a){return e(r(a))}}},foldl:function(n){var t=function(r){return function(e){var a=r,o=!1,u;function c(i,s){if(s instanceof v)return o=!0,i;if(s instanceof _){a=n(i)(s.value0),e=s.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[s.constructor.name])}for(;!o;)u=c(a,e);return u}};return t},foldMap:function(n){var t=C(n.Semigroup0()),r=fn(n);return function(e){return L(J)(function(a){var o=t(a);return function(u){return o(e(u))}})(r)}}},Nc=L(J);var xe={traverse:function(n){var t=n.Apply0(),r=m(t.Functor0()),e=Dt(t),a=S(n);return function(o){var u=r(Nc(mn(_.create))(v.value)),c=Nc(function(i){var s=e(mn(_.create))(i);return function(d){return s(o(d))}})(a(v.value));return function(i){return u(c(i))}}},sequence:function(n){return st(xe)(n)(j_)},Functor0:function(){return Cr},Foldable1:function(){return J}};var qc={eq1:function(n){var t=D(n);return function(r){return function(e){var a=function(o){return function(u){return function(c){var i=o,s=u,d=!1,h;function y(j,tn,un){if(!un)return d=!0,!1;if(j instanceof v&&tn instanceof v)return d=!0,un;if(j instanceof _&&tn instanceof _){i=j.value1,s=tn.value1,c=un&&t(tn.value0)(j.value0);return}return d=!0,!1}for(;!d;)h=y(i,s,c);return h}}};return a(r)(e)(!0)}}}},G_=ht(qc);var Sr=function(n){return{eq:G_(n)}};var V_={compare1:function(n){var t=F(n);return function(r){return function(e){var a=function(o){return function(u){var c=o,i=!1,s;function d(h,y){if(h instanceof v&&y instanceof v)return i=!0,$.value;if(h instanceof v)return i=!0,T.value;if(y instanceof v)return i=!0,I.value;if(h instanceof _&&y instanceof _){var j=t(h.value0)(y.value0);if(j instanceof $){c=h.value1,u=y.value1;return}return i=!0,j}throw new Error("Failed pattern match at Data.List.Types (line 60, column 5 - line 60, column 20): "+[h.constructor.name,y.constructor.name])}for(;!i;)s=d(c,u);return s}};return a(r)(e)}}},Eq10:function(){return qc}},Q_=wt(V_);var Me=function(n){var t=Sr(n.Eq0());return{compare:Q_(n),Eq0:function(){return t}}};var Y_=m(_n),Z_=k(J);var X_=L(J);var nt=function(n){return function(t){return Z_(_.create)(new _(t,v.value))(n)}},qt=function(n){return new _(n,v.value)};var Va=function(){var n=function(t){return function(r){var e=t,a=!1,o;function u(c,i){if(i instanceof v)return a=!0,c;if(i instanceof _){e=new _(i.value0,c),r=i.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[c.constructor.name,i.constructor.name])}for(;!a;)o=u(e,r);return o}};return n(v.value)}();var Lc=function(n){var t=function(r){return function(e){var a=r,o=!1,u;function c(i,s){if(s instanceof _&&n(s.value0)){a=new _(s.value0,i),e=s.value1;return}return o=!0,Va(i)}for(;!o;)u=c(a,e);return u}};return t(v.value)},$c=function(n){var t=function(r){return function(e){var a=r,o=!1,u;function c(i,s){if(i instanceof v)return o=!0,l.value;if(i instanceof _&&i.value1 instanceof v)return o=!0,new f({revInit:s,last:i.value0});if(i instanceof _){a=i.value1,e=new _(i.value0,s);return}throw new Error("Failed pattern match at Data.List (line 270, column 3 - line 270, column 21): "+[i.constructor.name,s.constructor.name])}for(;!o;)u=c(a,e);return u}};return Y_(function(r){return{init:Va(r.revInit),last:r.last}})(t(n)(v.value))},nv=function(n){return function(t){return function(r){var e=function(a){return function(o){return function(u){var c=a,i=o,s=!1,d;function h(y,j,tn){if(y instanceof v||j instanceof v)return s=!0,tn;if(y instanceof _&&j instanceof _){c=y.value1,i=j.value1,u=new _(n(y.value0)(j.value0),tn);return}throw new Error("Failed pattern match at Data.List (line 779, column 3 - line 779, column 21): "+[y.constructor.name,j.constructor.name,tn.constructor.name])}for(;!s;)d=h(c,i,u);return d}}};return Va(e(t)(r)(v.value))}}},Oc=function(){return nv(p.create)}();var Wc=X_(function(n){return function(t){return n+1|0}})(0),Uc=function(n){var t=!1,r;function e(a){if(a instanceof _&&a.value1 instanceof v)return t=!0,new f(a.value0);if(a instanceof _){n=a.value1;return}return t=!0,l.value}for(;!t;)r=e(n);return r};var Rc=function(n){if(n instanceof v)return l.value;if(n instanceof _)return new f(n.value0);throw new Error("Failed pattern match at Data.List (line 230, column 1 - line 230, column 22): "+[n.constructor.name])};var Jc=function(n,t,r){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+t+", line "+o+")",t,o);return e=1,a=r(),e=2,a}};var on=function(){function n(){}return n.value=new n,n}(),K=function(){function n(t,r,e,a,o,u){this.value0=t,this.value1=r,this.value2=e,this.value3=a,this.value4=o,this.value5=u}return n.create=function(t){return function(r){return function(e){return function(a){return function(o){return function(u){return new n(t,r,e,a,o,u)}}}}}},n}();var Ee=function(){function n(t,r,e){this.value0=t,this.value1=r,this.value2=e}return n.create=function(t){return function(r){return function(e){return new n(t,r,e)}}},n}();var In=function(n,t,r,e){if(r instanceof on){if(e instanceof on)return new K(1,1,n,t,r,e);if(e instanceof K)return new K(1+e.value0|0,1+e.value1|0,n,t,r,e);throw new Error("Failed pattern match at Data.Map.Internal (line 702, column 5 - line 706, column 39): "+[e.constructor.name])}if(r instanceof K){if(e instanceof on)return new K(1+r.value0|0,1+r.value1|0,n,t,r,e);if(e instanceof K)return new K(1+function(){var a=r.value0>e.value0;return a?r.value0:e.value0}()|0,(1+r.value1|0)+e.value1|0,n,t,r,e);throw new Error("Failed pattern match at Data.Map.Internal (line 708, column 5 - line 712, column 68): "+[e.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 700, column 32 - line 712, column 68): "+[r.constructor.name])};var Ka=function(n){return function(t){return new K(1,1,n,t,on.value,on.value)}},tr=function(){var n=function(e){if(e instanceof on)return 0;if(e instanceof K)return e.value0;throw new Error("Failed pattern match at Data.Map.Internal (line 757, column 12 - line 759, column 26): "+[e.constructor.name])},t=function(e,a,o,u,c,i,s){return i instanceof K&&i.value0>n(s)?In(i.value2,i.value3,In(e,a,o,i.value4),In(u,c,i.value5,s)):In(u,c,In(e,a,o,i),s)},r=function(e,a,o,u,c,i,s){return i instanceof K&&n(c)<=i.value0?In(i.value2,i.value3,In(o,u,c,i.value4),In(e,a,i.value5,s)):In(o,u,c,In(e,a,i,s))};return function(e,a,o,u){if(o instanceof on)return u instanceof on?Ka(e)(a):u instanceof K&&u.value0>1?t(e,a,o,u.value2,u.value3,u.value4,u.value5):In(e,a,o,u);if(o instanceof K){if(u instanceof K){if(u.value0>(o.value0+1|0))return t(e,a,o,u.value2,u.value3,u.value4,u.value5);if(o.value0>(u.value0+1|0))return r(e,a,o.value2,o.value3,o.value4,o.value5,u)}return u instanceof on&&o.value0>1?r(e,a,o.value2,o.value3,o.value4,o.value5,u):In(e,a,o,u)}throw new Error("Failed pattern match at Data.Map.Internal (line 717, column 40 - line 738, column 34): "+[o.constructor.name])}}(),Qa=Jc("unsafeSplit","Data.Map.Internal",function(){return function(n,t,r){if(r instanceof on)return new Ee(l.value,on.value,on.value);if(r instanceof K){var e=n(t)(r.value2);if(e instanceof T){var a=Qa(793)(n,t,r.value4);return new Ee(a.value0,a.value1,tr(r.value2,r.value3,a.value2,r.value5))}if(e instanceof I){var a=Qa(796)(n,t,r.value5);return new Ee(a.value0,tr(r.value2,r.value3,r.value4,a.value1),a.value2)}if(e instanceof $)return new Ee(new f(r.value3),r.value4,r.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 791, column 5 - line 799, column 30): "+[e.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 787, column 34 - line 799, column 30): "+[r.constructor.name])}}),rv=Qa(786);var Ha=Jc("unsafeUnionWith","Data.Map.Internal",function(){return function(n,t,r,e){if(r instanceof on)return e;if(e instanceof on)return r;if(e instanceof K){var a=rv(n,e.value2,r),o=Ha(809)(n,t,a.value1,e.value4),u=Ha(810)(n,t,a.value2,e.value5);if(a.value0 instanceof f)return tr(e.value2,t(a.value0.value0)(e.value3),o,u);if(a.value0 instanceof l)return tr(e.value2,e.value3,o,u);throw new Error("Failed pattern match at Data.Map.Internal (line 811, column 5 - line 815, column 46): "+[a.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 804, column 42 - line 815, column 46): "+[r.constructor.name,e.constructor.name])}}),ev=Ha(803),av=function(n){var t=F(n);return function(r){return function(e){return function(a){return ev(t,r,e,a)}}}},Bc=function(n){return av(n)(rn)};var kc=function(n){var t=F(n);return function(r){var e=function(a){var o=!1,u;function c(i){if(i instanceof on)return o=!0,!1;if(i instanceof K){var s=t(r)(i.value2);if(s instanceof T){a=i.value4;return}if(s instanceof I){a=i.value5;return}if(s instanceof $)return o=!0,!0;throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 7 - line 462, column 19): "+[s.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 456, column 8 - line 462, column 19): "+[i.constructor.name])}for(;!o;)u=c(a);return u};return e}};var jc=function(n){var t=F(n);return function(r){var e=function(a){var o=!1,u;function c(i){if(i instanceof on)return o=!0,l.value;if(i instanceof K){var s=t(r)(i.value2);if(s instanceof T){a=i.value4;return}if(s instanceof I){a=i.value5;return}if(s instanceof $)return o=!0,new f(i.value3);throw new Error("Failed pattern match at Data.Map.Internal (line 283, column 7 - line 286, column 22): "+[s.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 280, column 8 - line 286, column 22): "+[i.constructor.name])}for(;!o;)u=c(a);return u};return e}};var Ya=function(n){var t=F(n);return function(r){return function(e){var a=function(o){if(o instanceof on)return Ka(r)(e);if(o instanceof K){var u=t(r)(o.value2);if(u instanceof T)return tr(o.value2,o.value3,a(o.value4),o.value5);if(u instanceof I)return tr(o.value2,o.value3,o.value4,a(o.value5));if(u instanceof $)return new K(o.value0,o.value1,r,e,o.value4,o.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 471, column 7 - line 474, column 35): "+[u.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 468, column 8 - line 474, column 35): "+[o.constructor.name])};return a}}};var Za=function(){return on.value}(),zc=function(n){var t=Ya(n);return function(r){return L(r)(function(e){return function(a){return t(a.value0)(a.value1)(e)}})(Za)}};var Gc=Fa();var ov=function(n){return Gc(Bc(n))};var Vc=function(n){return Gc(kc(n))};var Qc=function(n){var t=Ya(n);return function(r){return function(e){return t(r)(void 0)(e)}}};var qn=Za;var Hc=function(n){var t=L(n);return function(r){return t(ov(r))(qn)}};function rr(n){return function(){n.preventDefault()}}function er(n){return function(t){return n[t]}}function Kc(n,t,r){return n==null?t:r(n)}var Ar=function(n){return Kc(n,l.value,f.create)};var Yc=function(n){var t=er(n);return function(r){return Ar(t(r))}};function Lt(n){return function(t){return function(r){return function(){n.addEventListener(t,r)}}}}var Ie=function(t){return function(r){return t(r)()}};var dt=function(t){return function(r){return function(){return t(r)}}},$t=function(t){return function(r){return function(e){return function(){return t(r,e)}}}},ar=function(t){return function(r){return function(e){return function(a){return function(){return t(r,e,a)}}}}};var Iv=function(n){return n},or=function(n){return Iv(Ie(n))};var Sv=function(){function n(){}return n.value=new n,n}(),ao=function(){function n(){}return n.value=new n,n}(),oo=function(){function n(){}return n.value=new n,n}(),Av=function(){function n(){}return n.value=new n,n}(),Pv=function(){function n(){}return n.value=new n,n}(),Nv=function(){function n(){}return n.value=new n,n}(),qv=function(){function n(){}return n.value=new n,n}(),Lv=function(){function n(){}return n.value=new n,n}(),uo=function(){function n(){}return n.value=new n,n}(),io=function(){function n(){}return n.value=new n,n}(),co=function(){function n(){}return n.value=new n,n}(),Xc=function(n){var t=function(r){return r==="deleteContent"?Sv.value:r==="deleteContentBackward"?ao.value:r==="deleteContentForward"?oo.value:r==="deleteByCut"?Av.value:r==="deleteWordBackward"?Pv.value:r==="deleteWordForward"?Nv.value:r==="deleteSoftLineBackward"?qv.value:r==="deleteSoftLineForward"?Lv.value:r==="insertText"?uo.value:r==="insertLineBreak"?io.value:r==="insertParagraph"?co.value:b("not implemented")};return t(er(n)("inputType"))},nf=function(n){var t=function(r){if(r instanceof l)return"";if(r instanceof f)return r.value0;throw new Error("Failed pattern match at FFI.DOM.Event.InputEvent (line 46, column 11 - line 46, column 30): "+[r.constructor.name])};return t(Yc(n)("data"))};var Ov=L(J),tf=pt(_t),Wv=zc(Q)(J),Uv=m(Cr),rf=function(){return v.value}(),ln=function(n){var t=qt({node:n,level:0,index:-1}),r=function(a){return function(o){var u=Fe(a.parent)(o),c={level:a.level,index:o,node:u};return{parent:u,level:a.level+1|0,z:nt(a.z)(c)}}},e=Ov(r)({parent:n,level:1,z:t});return function(a){return function(o){return o.z}(e(a))}};var ur=function(n){var t=function(a){return function(o){return function(u){return function(c){var i=nt(a)(o),s=new p(yn(u),i);return tf(t(i))(nt(c)(s))(U(u))}}}},r=tf(t(rf))(v.value)(U(n)),e=nt(r)(new p(yn(n),rf));return Wv(e)},ef=function(n){return function(t){return Uv(lt)(Lc(function(r){return r.value0.index===r.value1.index})(Oc(n)(t)))}};var Rv=Pa(xe);var Cn=function(n){var t=$c(n);if(t instanceof l)return b("Data.List.Unsafe.unsnoc: empty list");if(t instanceof f)return new p(t.value0.init,t.value0.last);throw new Error("Failed pattern match at Data.List.Unsafe (line 45, column 5 - line 47, column 43): "+[t.constructor.name])};var Ce=function(n){return function(t){if(n<=0)return new p(v.value,t);if(t instanceof v)return new p(v.value,v.value);if(n===1&&t instanceof _)return new p(qt(t.value0),t.value1);if(t instanceof _){var r=Ce(n-1|0)(t.value1);return new p(new _(t.value0,r.value0),r.value1)}throw new Error("Failed pattern match at Data.List.Unsafe (line 49, column 1 - line 49, column 56): "+[n.constructor.name,t.constructor.name])}},af=function(n){return function(t){return function(r){return nt(Rv(n)(t)(r))(t)}}};var of=function(n){var t=Uc(n);if(t instanceof l)return b("Data.List.Unsafe.last: empty list");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.List.Unsafe (line 21, column 5 - line 23, column 21): "+[t.constructor.name])};var Nr=function(n){var t=Rc(n);if(t instanceof l)return b("Data.List.Unsafe.head: empty list");if(t instanceof f)return t.value0;throw new Error("Failed pattern match at Data.List.Unsafe (line 15, column 5 - line 17, column 21): "+[t.constructor.name])};var Jv=Fr(_t),Bv=ya(Me(Q))(Q),kv=zr(Bv);var uf=k(J),jv=pt(_t),Ln=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),ir=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}();var cf=function(n){if(n instanceof P)return new f(new p(v.value,0));if(n instanceof vn)return l.value;var t=function(r){return function(e){return function(a){if(e instanceof l){var o=cf(a);if(o instanceof l)return l.value;if(o instanceof f)return new f(new p(new _(r,o.value0.value0),o.value0.value1));throw new Error("Failed pattern match at PlainText.Model.Selection (line 89, column 9 - line 93, column 43): "+[o.constructor.name])}return e}}};return Jv(t)(l.value)(U(n))},zv=function(n){return function(t){var r=n,e=!1,a;function o(u,c){if(c>=Fn(u))return e=!0,l.value;var i=cf(gn(u)(c));if(i instanceof l){r=u,t=c+1|0;return}if(i instanceof f)return e=!0,new f(new p(new _(c,i.value0.value0),i.value0.value1));throw new Error("Failed pattern match at PlainText.Model.Selection (line 101, column 5 - line 105, column 39): "+[i.constructor.name])}for(;!e;)a=o(r,t);return a}},ff=function(n){return function(t){return kv(n)(t)}};var lo=function(n){return function(t){var r=function(c){return function(i){if(i.mPoint instanceof l){var s=zv(U(c.node))(i.childIndex+1|0);return{mPoint:s,childIndex:c.index}}if(i.mPoint instanceof f){var s=new f(new p(new _(i.childIndex,i.mPoint.value0.value0),i.mPoint.value0.value1));return{childIndex:c.index,mPoint:s}}throw new Error("Failed pattern match at PlainText.Model.Selection (line 118, column 17 - line 124, column 56): "+[i.mPoint.constructor.name])}},e=ln(n)(t.value0),a=Cn(e),o={childIndex:a.value1.index,mPoint:l.value},u=t.value1<Cc(a.value1.node);return u?new f(new p(t.value0,t.value1+1|0)):function(c){return c.mPoint}(uf(r)(o)(a.value0))}},lf=function(n){if(n instanceof P)return new f(new p(v.value,Zn(n.value2)));if(n instanceof vn)return l.value;var t=function(r){return function(e){return function(a){if(a instanceof l){var o=lf(e);if(o instanceof l)return l.value;if(o instanceof f)return new f(new p(new _(r,o.value0.value0),o.value0.value1));throw new Error("Failed pattern match at PlainText.Model.Selection (line 44, column 9 - line 48, column 43): "+[o.constructor.name])}return a}}};return jv(t)(l.value)(U(n))},Gv=function(n){return function(t){var r=n,e=!1,a;function o(u,c){if(c<0)return e=!0,l.value;var i=lf(gn(u)(c));if(i instanceof l){r=u,t=c-1|0;return}if(i instanceof f)return e=!0,new f(new p(new _(c,i.value0.value0),i.value0.value1));throw new Error("Failed pattern match at PlainText.Model.Selection (line 56, column 5 - line 60, column 39): "+[i.constructor.name])}for(;!e;)a=o(r,t);return a}},sf=function(n){return function(t){if(t.value1>0)return new f(new p(t.value0,t.value1-1|0));var r=function(u){return function(c){if(c.mPoint instanceof l){var i=Gv(U(u.node))(c.childIndex-1|0);return{mPoint:i,childIndex:u.index}}if(c.mPoint instanceof f){var i=new f(new p(new _(c.childIndex,c.mPoint.value0.value0),c.mPoint.value0.value1));return{childIndex:u.index,mPoint:i}}throw new Error("Failed pattern match at PlainText.Model.Selection (line 72, column 9 - line 78, column 48): "+[c.mPoint.constructor.name])}},e=Cn(t.value0),a={childIndex:e.value1,mPoint:l.value},o=ln(n)(e.value0);return function(u){return u.mPoint}(uf(r)(a)(o))}};function po(n,t){n.$$x=t}function _o(n){return function(t){return{node:n,domNode:t,text:!0}}}function vo(n){return function(t){return function(r){return{node:n,domNode:t,domText:r,text:!0}}}}function mo(n){return function(t){return{...n,node:t}}}function Do({node:n,offset:t}){if(t>0)return null;if(n.nodeName==="BR"&&n.$$x?.text===!0)return n.$$x;if(n.childNodes.length===1){let r=n.childNodes[0];if(r.nodeName==="BR"&&r.$$x?.text===!0)return r.$$x}return null}function ho(n){return n.domNode.nodeName==="BR"?n.domNode:n.domText}function Se(n,t,r){return t==null?null:t.$$x?.node!=null&&r(t.$$x.node)?t.$$x:t!==n?Se(n,t.parentNode,r):null}function yo(n){return n.$$x==null?[]:n.$$x.children}function bo(n,t){n.$$x.domText.data=t}function go(){return{}}function wo(n){return function(t){return function(r){return function(){return r[n]=t,r}}}}function pf(n){return n()}var nm=pn(Kr);var _f=function(n){return function(t){return pf(nm(go)(wo(n)(t)))}};function cr(n){return function(t){return function(){n.append(t)}}}function Fo(n){return function(t){return function(){n.after(t)}}}function xo(n){return function(t){return function(){n.replaceWith(t)}}}function Mo(n){return function(){n.remove()}}function To(n){return function(t){return function(){Object.assign(n,t)}}}function Eo(n){return function(t){return n===t}}var vf={eq:Eo};var mf=function(n){var t=F(n);return function(r){var e=Ma(r);return function(a){return function(o){var u=e(function(c){return function(i){return t(a(c))(a(i))}})(o);if(u instanceof l)return b("minimumOn: empty");if(u instanceof f)return u.value0;throw new Error("Failed pattern match at Data.Foldable.Unsafe (line 17, column 5 - line 19, column 22): "+[u.constructor.name])}}}};var df=function(n){var t=L(n);return function(r){return function(e){var a=function(u){return function(c){return new f(function(){if(u instanceof l)return c;if(u instanceof f)return r(u.value0)(c);throw new Error("Failed pattern match at Data.Foldable.Unsafe (line 49, column 20 - line 51, column 37): "+[u.constructor.name])}())}},o=t(a)(l.value)(e);if(o instanceof l)return b("foldl1: empty");if(o instanceof f)return o.value0;throw new Error("Failed pattern match at Data.Foldable.Unsafe (line 45, column 5 - line 47, column 21): "+[o.constructor.name])}}};var um=Vc(Q),im=mf(Q)(an),Ae=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),Pe=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}(),cm=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}(),qr=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),Lr=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}();var fm=function(){var n=function(r){return function(e){return new p(R(r.value0)(new Lr(e)),r.value1+1|0)}},t=new p([],0);return ec(n)(t)}(),lm=function(n){return function(t){return function(r){return function(e){var a=gn(r)(0),o=function(c){return function(i){return function(s){if(yn(e)===s){var h=gn(r)(c),d=function(){var tn=um(s)(t);return tn?new Pe(s,e):new Ae(s)}();return new p(R(h.value0)(d),h.value1)}var h=gn(r)(c+1|0),y=gn(r)(c);return im(Kn)([new p(R(i.value0)(new Lr(s)),i.value1+1|0),new p(R(y.value0)(new cm(s,e)),y.value1+1|0),new p(R(h.value0)(new qr(e)),h.value1+1|0)])}}},u=new p(R(a.value0)(new qr(e)),a.value1+1|0);return rc(o)(u)(n)}}}},hf=function(n){return function(t){return function(r){var e=lr(n),a=lr(t),o=_e(lm(e)(r))(fm(e))(a),u=he(o);return lr(u.value0)}}};var pm=Wr(xt),Ot=S(Mt),gf=gi(an)(xt),_m=m(bn),vm=D(vf);var Ne=function(n){return yn(n.node)},Io=$t(po),mm=$t(bo),dm=function(n){return function(t){return function(r){return t instanceof P&&r instanceof P?pm(Ot(t.value2!==r.value2))(mm(n)(r.value2)):Ot(void 0)}}},Dm=function(n){return n===1?"h1":n===2?"h2":n===3?"h3":n===4?"h4":n===5?"h5":n===6?"h6":b("headingTag: invalid level")},hm=dt(yo),wf=dt(Do),Co=function(n){return function(t){return n.italic?function(){var e=Bn("em")(),a=Co({bold:n.bold,italic:!1})(t)();return function(){if(a.value0 instanceof l)return cr(e)(a.value1)();if(a.value0 instanceof f)return cr(e)(a.value0.value0)();throw new Error("Failed pattern match at PlainText.View.Node (line 154, column 5 - line 156, column 42): "+[a.value0.constructor.name])}(),new p(new f(e),a.value1)}:n.bold?function(){var e=Bn("strong")(),a=Co({italic:n.italic,bold:!1})(t)();return cr(e)(a.value1)(),new p(new f(e),a.value1)}:function(){var e=Ke(t)();return new p(l.value,e)}}},yf=function(n){return n instanceof P?function(){var r=Co(n.value1)(n.value2)(),e=function(){if(r.value0 instanceof l)return new p(r.value1,r.value1);if(r.value0 instanceof f)return new p(r.value0.value0,r.value1);throw new Error("Failed pattern match at PlainText.View.Node (line 138, column 31 - line 140, column 37): "+[r.value0.constructor.name])}();return vo(n)(e.value0)(e.value1)}:b("createTextViewNode: invalid call")},bf=function(n){return function(){var r=Bn("br")();return _o(n)(r)}},ym=function(n){if(n instanceof Jn)return Bn(Dm(n.value0.level));if(n instanceof wn)return Bn("p");if(n instanceof Xn)return function(){var r=Bn("a")();return To(r)(_f("href")(n.value0.href))(),r};throw new Error("Failed pattern match at PlainText.View.Node (line 167, column 1 - line 167, column 50): "+[n.constructor.name])},bm=function(n){return function(t){if(t instanceof qr){if(t.value0 instanceof P)return function(){var i=function(){var d=t.value0.value2==="";return d?bf(t.value0)():yf(t.value0)()}(),s=new p(new p(t,l.value),new f(i));return new p(n.value0,R(n.value1)(s))};if(t.value0 instanceof vn)return function(){var i=Bn("br")(),s={node:t.value0,domNode:i,children:[]},d=new p(new p(t,l.value),new f(s));return new p(n.value0,R(n.value1)(d))};if(t.value0 instanceof H)return function(){var i=ym(t.value0.value1)(),s={node:t.value0,domNode:i,children:[]},d=new p(new p(t,l.value),new f(s));return new p(n.value0,R(n.value1)(d))};if(t.value0 instanceof hn)return b("patchOp: invalid call on Root");throw new Error("Failed pattern match at PlainText.View.Node (line 84, column 5 - line 102, column 56): "+[t.value0.constructor.name])}if(t instanceof Pe){var r=de(n.value0);if(t.value1 instanceof P){var e=Tn(t.value1),a=Tn(r.value0.node);if(a===""&&Zn(e)>0)return function(){var d=yf(t.value1)(),h=new p(new p(t,new f(r.value0)),new f(d));return new p(r.value1,R(n.value1)(h))};if(e===""&&Zn(a)>0)return function(){var d=bf(t.value1)(),h=new p(new p(t,new f(r.value0)),new f(d));return new p(r.value1,R(n.value1)(h))};var o=mo(r.value0)(t.value1),u=new p(new p(t,new f(r.value0)),new f(o));return Ot(new p(r.value1,R(n.value1)(u)))}var o={domNode:r.value0.domNode,children:r.value0.children,node:t.value1},u=new p(new p(t,new f(r.value0)),new f(o));return Ot(new p(r.value1,R(n.value1)(u)))}if(t instanceof Ae){var r=de(n.value0),u=new p(new p(t,new f(r.value0)),new f(r.value0));return Ot(new p(r.value1,R(n.value1)(u)))}if(t instanceof Lr){var r=de(n.value0),u=new p(new p(t,new f(r.value0)),l.value);return Ot(new p(r.value1,R(n.value1)(u)))}return b("not implemented")}},gm=function(n){return function(t){var r=new p(t,[]);return function(){var a=gf(bm)(r)(n)();return a.value1}}},So=function(n){return function(t){return function(r){return function(){var a=hm(t)(),o=_m(Ne)(a),u=hf(o)(U(r))(n),c=gm(u)(a)(),i=wm(n)(t)(r)(c)();return{node:r,domNode:t,children:i}}}}},wm=function(n){return function(t){return function(r){return function(e){return function(){var o=gf(Fm(n)(t))({sibling:l.value,z:[]})(e)();return o.z}}}}},Fm=function(n){return function(t){return function(r){return function(e){return e.value0.value0 instanceof qr&&e.value1 instanceof f?function(){var o=function(){return e.value1.value0.node instanceof H?So(n)(e.value1.value0.domNode)(e.value1.value0.node)():e.value1.value0}();Io(e.value1.value0.domNode)(o)(),function(){if(r.sibling instanceof l)return cr(t)(e.value1.value0.domNode)();if(r.sibling instanceof f)return Fo(r.sibling.value0)(e.value1.value0.domNode)();throw new Error("Failed pattern match at PlainText.View.Node (line 206, column 5 - line 210, column 36): "+[r.sibling.constructor.name])}();var u=R(r.z)(o),c=new f(e.value1.value0.domNode);return{sibling:c,z:u}}:e.value0.value0 instanceof Pe&&e.value0.value1 instanceof f&&e.value1 instanceof f?function(){(function(){var i=vm(e.value0.value1.value0.domNode)(e.value1.value0.domNode);return i?dm(e.value1.value0.domNode)(e.value0.value1.value0.node)(e.value1.value0.node)():xo(e.value0.value1.value0.domNode)(e.value1.value0.domNode)()})();var o=function(){return e.value1.value0.node instanceof H?So(n)(e.value1.value0.domNode)(e.value1.value0.node)():e.value1.value0}();Io(e.value1.value0.domNode)(o)();var u=R(r.z)(o),c=new f(e.value1.value0.domNode);return{sibling:c,z:u}}:e.value0.value0 instanceof Ae&&e.value1 instanceof f?Ot({sibling:new f(e.value1.value0.domNode),z:R(r.z)(e.value1.value0)}):e.value0.value0 instanceof Lr&&e.value0.value1 instanceof f?function(){return Mo(e.value0.value1.value0.domNode)(),r}:b("not implemented")}}}},Ao=function(n){return function(t){return function(r){return function(){var a=So(n)(t)(r)();return Io(t)(a)(),a}}}},Ff=ar(Se);function qe(n){return n instanceof window.Text}function Po(n){return n instanceof window.Element}function No(n){return Tf(n)??Mf(n)}function Mf({node:n,offset:t}){if(qe(n))return{node:n,offset:t};if(Po(n))for(let r=t;r<n.childNodes.length;r=r+1){let e=n.childNodes[r],a=Mf({node:e,offset:0});if(a!=null)return a}return null}function Tf({node:n,offset:t}){if(qe(n))return{node:n,offset:t};if(Po(n))for(let r=t-1;r>=0;r=r-1){let e=n.childNodes[r],a=qe(e)?e.length:e.childNodes.length,o=Tf({node:e,offset:a});if(o!=null)return o}return null}function qo(n,t){return n==null||n.anchorNode==null||n.focusNode==null?!1:t.contains(n.anchorNode)&&t.contains(n.focusNode)}function Lo(n,t,r){n.anchorNode===t.node&&n.anchorOffset===t.offset&&n.focusNode===r.node&&n.focusOffset===r.offset||n.setBaseAndExtent(t.node,t.offset,r.node,r.offset)}function Le(){return window.document.getSelection()}function $e(n){return{node:n.anchorNode,offset:n.anchorOffset}}function $o(n){return{node:n.focusNode,offset:n.focusOffset}}function Oo(n){return n.isCollapsed}function Wo(n){n.removeAllRanges()}var Ef=function(n){var t=jc(n);return function(r){return function(e){var a=t(r)(e);if(a instanceof l)return b("lookup: key missisng");if(a instanceof f)return a.value0;throw new Error("Failed pattern match at Data.Map.Unsafe (line 11, column 5 - line 13, column 21): "+[a.constructor.name])}}};var If=Ef(Q),Cf=function(n){return function(t){return function(){var e=wf(t)(),a=If(Ne(e))(n);return new p(a,0)}}},Oe=function(n){return function(t){return function(r){return function(){var a=Ff(n)(r.node)(Er)(),o=If(Ne(a))(t);return new p(o,r.offset)}}}},Sf=$t(qo),We=ar(Lo),Ue=function(){var n=m(Tt)(Ar),t=dt(No);return function(r){return n(t(r))}}(),Tm=function(){var n=function(t){return function(r){return gn(t.children)(r)}};return L(J)(n)}(),Uo=function(n){return function(t){var r=Tm(t)(n.value0);return{node:ho(r),offset:n.value1}}},Af=function(n){return function(t){if(n instanceof Ln){var r=Uo(n.value0)(t);return{anchor:r,focus:r}}if(n instanceof ir)return{anchor:Uo(n.value0.anchor)(t),focus:Uo(n.value0.focus)(t)};throw new Error("Failed pattern match at PlainText.View.Selection (line 62, column 1 - line 62, column 51): "+[n.constructor.name,t.constructor.name])}},Pf=dt(Wo);var Im=k(J),Cm=m(bn),Nf=C(rt),Sm=df(an),Ro=function(n){return function(t){var r=function(e){return function(a){var o=Ir(a.index)(a.node)(e.node);return{node:o,index:e.index}}};return function(e){return e.node}(Im(r)({node:t.node,index:t.index})(n))}},Am=function(n){return function(t){return n instanceof P&&t instanceof P?new P(n.value0,n.value1,n.value2+t.value2):b("PlainText.Model.NodeOperation.Internal.joinText: invalid call")}},qf=function(n){return function(t){return function(r){return function(e){var a=Cn(ln(e)(n)),o=Cm(function(s){return Fe(a.value1.node)(s)})(Vi(t)(r)),u=Nf(we(a.value1.node)(t))(Nf([Sm(Am)(o)])(ge(a.value1.node)(r+1|0))),c=Mn(u)(a.value1.node),i={index:a.value1.index,level:a.value1.level,node:c};return Ro(a.value0)(i)}}}},Lf=function(n){return function(t){return function(r){var e=Cn(n),a=Cn(ln(r)(e.value0)),o=Ac(e.value1)(t)(a.value1.node),u={index:a.value1.index,level:a.value1.level,node:o};return Ro(a.value0)(u)}}},$f=function(n){return function(t){var r=Cn(n),e=Cn(ln(t)(r.value0)),a=Sc(r.value1)(e.value1.node),o={index:e.value1.index,level:e.value1.level,node:a};return Ro(e.value0)(o)}};var Re=function(){function n(){}return n.value=new n,n}(),Je=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),Be=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),ke=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}();var Wf=ia(),Uf=Br(ua)(),Nm=D(Wf(Br(Uf({reflectSymbol:function(){return"italic"}})(_r))()({reflectSymbol:function(){return"bold"}})(_r))),qm=D(Wf(Uf({reflectSymbol:function(){return"href"}})(oa))),Rf=function(n){return function(t){return n instanceof P&&t instanceof P?Nm(n.value1)(t.value1):n instanceof H&&t instanceof H?n.value1 instanceof Xn&&t.value1 instanceof Xn?qm(n.value1.value0)(t.value1.value0):n.value1 instanceof wn&&t.value1 instanceof wn||n.value1 instanceof Jn&&t.value1 instanceof Jn||n.value1 instanceof wn&&t.value1 instanceof Jn||n.value1 instanceof Jn&&t.value1 instanceof wn:!1}},Jo=function(n){return n instanceof P||n instanceof vn||n instanceof H&&n.value1 instanceof Xn},Jf=function(){var n=Gt(ct);return function(t){return n(Jo(t))}}();var $m=m(Cr),Bf=k(J),fr=C(rt),kf=function(n){return function(t){return function(r){var e=$m(function(u){return u.level})(ef(t)(r)),a=Ce(n)(e),o=Wc(a.value1)===0;return o?new p(-1,-1):new p(Nr(a.value1),of(a.value1))}}},jf=function(n){return function(t){var r=function(e){return function(a){var o=Ir(a.index)(a.node)(e.node);return{node:o,index:e.index,level:e.level}}};return af(r)(t)(n)}},zf=function(n){return function(t){var r=function(a){return function(o){var u=a.level>=n.value0&&a.level<=n.value1;if(u){var c=Tc(o.int)(a.node),i=function(){if(o.child instanceof l)return c;if(o.child instanceof f)return Ir(0)(o.child.value0)(c);throw new Error("Failed pattern match at PlainText.Model.Splice.Internal (line 155, column 26 - line 157, column 55): "+[o.child.constructor.name])}(),s={level:a.level,index:a.index,node:i};return{int:o.int+1|0,child:new f(c),z:new _(s,o.z)}}return{int:o.int,child:o.child,z:new _(a,o.z)}}},e=Bf(r)({int:t,child:l.value,z:v.value});return function(a){return function(o){return o.z}(e(a))}}},Bo=function(n){return function(t){if(Rf(n)(t)){var r=Er(n);if(r){var e=Tn(n)+Tn(t),c=nr(e)(n);return[c]}var a=U(t),o=U(n),u=function(){return o.length===0?a:a.length===0?o:fr(ye(o))(fr(Bo(he(o))(xr(a)))(De(a)))}(),c=Mn(u)(n);return[c]}return[n,t]}},ko=function(n){return function(t){return function(r){if(t instanceof _&&r instanceof _&&t.value0.index===r.value0.index&&t.value0.level<n){var e=fr(ye(U(t.value0.node)))(fr(ko(n)(t.value1)(r.value1))(De(U(r.value0.node)))),a=Mn(e)(t.value0.node);return[a]}return t instanceof _&&r instanceof _?Bo(t.value0.node)(r.value0.node):b("PlainText.Model.Splice.joinUntil: invalid call")}}},Gf=function(n){return function(t){if(n instanceof _&&n.value1 instanceof v&&t instanceof _&&t.value1 instanceof v&&n.value0.index===t.value0.index){var r=Tn(n.value0.node)+Tn(t.value0.node),e=nr(r)(n.value0.node);return[e]}if(n instanceof _&&t instanceof _&&n.value0.index===t.value0.index){var a=fr(ye(U(n.value0.node)))(fr(Gf(n.value1)(t.value1))(De(U(t.value0.node)))),e=Mn(a)(n.value0.node);return[e]}return n instanceof _&&t instanceof _?Bo(n.value0.node)(t.value0.node):b("PlainText.Model.Splice.join: invalid call")}},Om=function(){var n=function(e){return function(a){return e instanceof l&&Jo(a.node)?new f(a.level):e}},t=Vr(0),r=L(J)(n)(l.value);return function(e){return t(r(e))}}(),je=function(n){return function(t){if(t instanceof v)return v.value;if(t instanceof _&&t.value1 instanceof v){var r=Ic(t.value0.node)(n),e=nr(r)(t.value0.node),a={index:t.value0.index,level:t.value0.level,node:e};return qt(a)}if(t instanceof _){var o=je(n)(t.value1),u=Nr(o),c=we(t.value0.node)(u.index),e=Mn(R(c)(u.node))(t.value0.node),a={index:t.value0.index,level:t.value0.level,node:e};return new _(a,o)}throw new Error("Failed pattern match at PlainText.Model.Splice.Internal (line 32, column 1 - line 32, column 55): "+[n.constructor.name,t.constructor.name])}},ze=function(n){return function(t){if(t instanceof v)return v.value;if(t instanceof _&&t.value1 instanceof v){var r=Ec(t.value0.node)(n),e=nr(r)(t.value0.node),a={index:t.value0.index,level:t.value0.level,node:e};return qt(a)}if(t instanceof _){var o=ze(n)(t.value1),u=Nr(o),c=ge(t.value0.node)(u.index+1|0),e=Mn(wr(u.node)(c))(t.value0.node),a={index:t.value0.index,level:t.value0.level,node:e};return new _(a,o)}throw new Error("Failed pattern match at PlainText.Model.Splice.Internal (line 16, column 1 - line 16, column 54): "+[n.constructor.name,t.constructor.name])}},Wm=function(){var n=function(e){return function(a){return a instanceof l&&Jf(e.node)?new f(e.level):a}},t=Vr(0),r=Bf(n)(l.value);return function(e){return t(r(e))}}(),Um=function(n){return function(t){if(n==="")return t;var r=Cn(t),e=Tn(r.value1.node)+n,a=nr(e)(r.value1.node),o={index:r.value1.index,level:r.value1.level,node:a};return jf(r.value0)(o)}},jo=function(n){return function(t){return function(r){return function(e){if(n.value0 instanceof v&&t.value0 instanceof v)return e;var a=ze(t.value1)(ln(e)(t.value0)),o=Um(r)(je(n.value1)(ln(e)(n.value0)));return xr(Gf(o)(a))}}}},Vf=function(n){return function(t){return jo(n)(t)("")}},Qf=function(n){return function(t){return function(r){var e=Ce(n)(r),a=Cn(e.value0),o=Nr(e.value1),u={level:o.level,node:t,index:o.index+1|0},c=R(U(a.value1.node))(t),i=Mn(c)(a.value1.node),s={index:a.value1.index,level:a.value1.level,node:i};return nt(jf(a.value0)(s))(u)}}},Hf=function(n){return function(t){return function(r){return function(e){var a=ln(e)(t.value0),o=ln(e)(n.value0),u=Wm(o),c=Qf(u)(r)(je(n.value1)(o)),i=yn(r),s=zf(kf(u)(o)(a))(i+1|0)(ze(t.value1)(a));return xr(ko(u)(c)(s))}}}},Kf=function(n){return function(t){return function(r){return function(e){var a=ln(e)(t.value0),o=ln(e)(n.value0),u=Om(o),c=Qf(u)(r)(je(n.value1)(o)),i=yn(r),s=zf(kf(u)(o)(a))(i+1|0)(ze(t.value1)(a));return xr(ko(u)(c)(s))}}}};var $r=function(){function n(t,r,e){this.value0=t,this.value1=r,this.value2=e}return n.create=function(t){return function(r){return function(e){return new n(t,r,e)}}},n}(),Jm=function(){function n(t,r){this.value0=t,this.value1=r}return n.create=function(t){return function(r){return new n(t,r)}},n}(),Bm=function(){function n(t){this.value0=t}return n.create=function(t){return new n(t)},n}(),km=function(){function n(t,r,e){this.value0=t,this.value1=r,this.value2=e}return n.create=function(t){return function(r){return function(e){return new n(t,r,e)}}},n}(),Ge=function(n){if(n instanceof $r){if(n.value2 instanceof Re)return Vf(n.value0)(n.value1);if(n.value2 instanceof Je)return jo(n.value0)(n.value1)(n.value2.value0);if(n.value2 instanceof Be)return Kf(n.value0)(n.value1)(n.value2.value0);if(n.value2 instanceof ke)return Hf(n.value0)(n.value1)(n.value2.value0);throw new Error("Failed pattern match at PlainText.Model.Operation (line 19, column 5 - line 27, column 32): "+[n.value2.constructor.name])}if(n instanceof Jm)return Lf(n.value0)(n.value1);if(n instanceof Bm)return $f(n.value0);if(n instanceof km)return qf(n.value0)(n.value1)(n.value2);throw new Error("Failed pattern match at PlainText.Model.Operation (line 17, column 1 - line 17, column 44): "+[n.constructor.name])};var zm=yt(Sr(Jt)),Gm=Qc(Q),Vm=k(J),Qm=Hc(an)(Q),Hm=m(_n),Yf=function(n){return function(t){return zm(n.value0)(t.value0)}},zo=function(n){return function(t){return function(r){var e=function(o){return Gm(yn(o.node))},a=Vm(e)(qn);return Qm([a(ln(n)(t.value0)),a(ln(n)(r.value0))])}}},Go=function(n){return function(t){return{root:t.root,pathIndex:t.pathIndex,selection:new f(n)}}},Ve=function(n){if(n instanceof Ln)return new p(n.value0,n.value0);if(n instanceof ir){var t=ff(n.value0.anchor)(n.value0.focus);return t?new p(n.value0.anchor,n.value0.focus):new p(n.value0.focus,n.value0.anchor)}throw new Error("Failed pattern match at PlainText.View.State (line 131, column 1 - line 131, column 44): "+[n.constructor.name])},Km=function(n){return new p(n.value0,n.value1-1|0)},Ym=function(n){return function(t){return new p(t.value0,t.value1+Zn(n)|0)}},Zf=function(n){return function(t){if(t.selection instanceof l)return new p(qn,t);if(t.selection instanceof f){var r=Ve(t.selection.value0),e=new f(new Ln(Ym(n)(r.value0))),a=Ge(new $r(r.value0,r.value1,new Je(n)))(t.root),o=function(){var i=Yf(r.value0)(r.value1);return i?ur(a):t.pathIndex}(),u={root:a,selection:e,pathIndex:o},c=zo(t.root)(r.value0)(r.value1);return new p(c,u)}throw new Error("Failed pattern match at PlainText.View.State (line 34, column 5 - line 49, column 33): "+[t.selection.constructor.name])}},Xf=function(n){return function(t){if(t.selection instanceof l)return new p(qn,t);if(t.selection instanceof f){var r=Ve(t.selection.value0),e=Ge(new $r(r.value0,r.value1,n))(t.root),a=Hm(Ln.create)(lo(e)(r.value0)),o=ur(e),u={root:e,selection:a,pathIndex:o},c=zo(t.root)(r.value0)(r.value1);return new p(c,u)}throw new Error("Failed pattern match at PlainText.View.State (line 116, column 5 - line 129, column 33): "+[t.selection.constructor.name])}},nl=function(n){var t=Ga(n.root)+1|0,r=new H({id:t},new wn({}),[]);return Xf(new ke(r))(n)},tl=function(n){var t=Ga(n.root)+1|0,r=new vn({id:t});return Xf(new Be(r))(n)},Or=function(n){return function(t){return function(r){var e=new f(new Ln(n)),a=Ge(new $r(n,t,Re.value))(r.root),o=function(){var i=Yf(n)(t);return i?ur(a):r.pathIndex}(),u={root:a,selection:e,pathIndex:o},c=zo(r.root)(n)(t);return new p(c,u)}}},rl=function(n){if(n.selection instanceof l)return new p(qn,n);if(n.selection instanceof f&&n.selection.value0 instanceof Ln){var t=lo(n.root)(n.selection.value0.value0);if(t instanceof l)return new p(qn,n);if(t instanceof f)return Or(n.selection.value0.value0)(t.value0)(n);throw new Error("Failed pattern match at PlainText.View.State (line 75, column 13 - line 79, column 42): "+[t.constructor.name])}if(n.selection instanceof f){var t=Ve(n.selection.value0);return Or(t.value0)(t.value1)(n)}throw new Error("Failed pattern match at PlainText.View.State (line 71, column 5 - line 82, column 42): "+[n.selection.constructor.name])},el=function(n){if(n.selection instanceof l)return new p(qn,n);if(n.selection instanceof f&&n.selection.value0 instanceof Ln){var t=n.selection.value0.value0.value1>0;if(t)return Or(Km(n.selection.value0.value0))(n.selection.value0.value0)(n);var r=sf(n.root)(n.selection.value0.value0);if(r instanceof l)return new p(qn,n);if(r instanceof f)return Or(r.value0)(n.selection.value0.value0)(n);throw new Error("Failed pattern match at PlainText.View.State (line 60, column 17 - line 64, column 46): "+[r.constructor.name])}if(n.selection instanceof f){var r=Ve(n.selection.value0);return Or(r.value0)(r.value1)(n)}throw new Error("Failed pattern match at PlainText.View.State (line 53, column 5 - line 67, column 42): "+[n.selection.constructor.name])},al=function(n){return{root:n.root,pathIndex:n.pathIndex,selection:l.value}};var Xm=sn(Tt),Vo=Wr(xt),Qo=S(Mt),nd=yt(Tr),ol=function(n){return function(t){return function(){Xm(Ao(qn)(n)(t))();var e=va({root:t,pathIndex:ur(t),selection:l.value})();return Lt(n)("dragstart")(or(rr))(),Lt(n)("paste")(or(rr))(),Lt(n)("cut")(or(rr))(),Lt(He)("selectionchange")(or(function(a){return function(){var u=Le(),c=Sf(u)(n)();return Vo(Qo(c))(function(){var s=zt(e)(),d=Oo(u);if(d){var h=$e(u),un=Ue(h)();(function(){if(un instanceof f)return We(u)(un.value0)(un.value0)();if(un instanceof l)return void 0;throw new Error("Failed pattern match at PlainText.View.Editor (line 44, column 17 - line 48, column 34): "+[un.constructor.name])})();var y=An(Cf(s.pathIndex)(h))(Oe(n)(s.pathIndex))(un)(),j=new Ln(y),tn=Go(j)(s);return It(tn)(e)()}var un=Ue($e(u))(),Wt=Ue($o(u))();if(un instanceof f&&Wt instanceof f){We(u)(un.value0)(Wt.value0)();var h=Oe(n)(s.pathIndex)(un.value0)(),Qe=Oe(n)(s.pathIndex)(Wt.value0)(),j=new ir({anchor:h,focus:Qe}),tn=Go(j)(s);return It(tn)(e)()}return b("not implemented")()})(),Vo(Qo(!c))(function(){var s=zt(e)(),d=al(s);return It(d)(e)()})()}}))(),Lt(n)("beforeinput")(or(function(a){return function(){rr(a)();var u=function(){var s=Xc(a);return s instanceof ao?el:s instanceof oo?rl:s instanceof uo?Zf(nf(a)):s instanceof io?tl:s instanceof co?nl:b("not implemented")}(),c=zt(e)(),i=u(c);return It(i.value1)(e)(),Vo(Qo(nd(c.root)(i.value1.root)))(function(){var d=Ao(i.value0)(n)(i.value1.root)(),h=Le();if(i.value1.selection instanceof l)return Pf(h)();if(i.value1.selection instanceof f){var y=Af(i.value1.selection.value0)(d);return We(h)(y.anchor)(y.focus)()}throw new Error("Failed pattern match at PlainText.View.Editor (line 99, column 13 - line 104, column 59): "+[i.value1.selection.constructor.name])})()}}))()}}};var rd=function(){return P.create}(),ul=function(n){return rd(n)({italic:!1,bold:!1})};var il=function(n){return H.create(n)(new wn({}))};var ad=function(){return new hn({id:1},[il({id:2})([ul({id:3})("hello world")])])}(),cl=function(){var t=Ye("editor-1")();return ol(t)(ad)()};cl();})();
